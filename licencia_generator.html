<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Generador Licencia de Conducir</title>
<style>
    body { font-family: Arial, sans-serif; background: #f0f0f0; padding: 20px; }
    .formulario { background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
    .canvas-container { text-align: center; }
    canvas { border: 1px solid #ccc; }
</style>
</head>
<body>

<h2>Generador Licencia de Conducir</h2>

<div class="formulario">
    <label>Plantilla Licencia: <input type="file" id="template" accept="image/*"></label><br><br>
    <label>Selfie: <input type="file" id="selfie" accept="image/*"></label><br><br>
    <label>Apellido: <input type="text" id="apellido"></label><br><br>
    <label>Nombre: <input type="text" id="nombre"></label><br><br>
    <label>Domicilio: <input type="text" id="domicilio"></label><br><br>
    <label>Fecha Nac.: <input type="date" id="fechaNac"></label><br><br>
    <label>Otorgamiento: <input type="date" id="otorgamiento"></label><br><br>
    <label>Vencimiento: <input type="date" id="vencimiento"></label><br><br>
    <label>NÂ° Licencia: <input type="text" id="nLicencia"></label><br><br>
    <label>Clase: <input type="text" id="clase"></label><br><br>
    <label>Marca de Agua: <input type="text" id="marcaAgua"></label><br><br>
    <button onclick="generarLicencia()">Generar Licencia</button>
    <button onclick="descargar()">Descargar</button>
</div>

<div class="canvas-container">
    <canvas id="licenciaCanvas" width="1093" height="768"></canvas>
</div>

<script>
let templateImg = null;
let selfieImg = null;

document.getElementById('template').addEventListener('change', function(e) {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = function(evt) {
        templateImg = new Image();
        templateImg.onload = generarLicencia;
        templateImg.src = evt.target.result;
    };
    reader.readAsDataURL(file);
});

document.getElementById('selfie').addEventListener('change', function(e) {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = function(evt) {
        selfieImg = new Image();
        selfieImg.onload = generarLicencia;
        selfieImg.src = evt.target.result;
    };
    reader.readAsDataURL(file);
});

function generarLicencia() {
    const canvas = document.getElementById('licenciaCanvas');
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0,0,canvas.width, canvas.height);

    if (templateImg) {
        ctx.drawImage(templateImg, 0, 0, canvas.width, canvas.height);
    }

    // Selfie en el recuadro izquierdo
    if (selfieImg) {
        const fotoSize = 300;
        ctx.drawImage(selfieImg, 60, 200, fotoSize, fotoSize);
    }

    ctx.font = "bold 30px Arial";
    ctx.fillStyle = "black";
    ctx.textBaseline = "top";

    ctx.fillText(document.getElementById('apellido').value, 420, 120);
    ctx.fillText(document.getElementById('nombre').value, 420, 160);
    ctx.fillText(document.getElementById('domicilio').value, 420, 200);
    ctx.fillText(document.getElementById('fechaNac').value, 420, 240);
    ctx.fillText(document.getElementById('otorgamiento').value, 420, 280);
    ctx.fillText(document.getElementById('vencimiento').value, 700, 280);
    ctx.fillText(document.getElementById('nLicencia').value, 420, 80);
    ctx.fillText(document.getElementById('clase').value, 900, 80);

    // Marca de agua
    let marca = document.getElementById('marcaAgua').value;
    if (marca) {
        ctx.font = "bold 60px Arial";
        ctx.fillStyle = "rgba(0,0,0,0.1)";
        ctx.save();
        ctx.translate(canvas.width/2, canvas.height/2);
        ctx.rotate(-Math.PI/6);
        ctx.textAlign = "center";
        ctx.fillText(marca, 0, 0);
        ctx.restore();
    }
}

function descargar() {
    const canvas = document.getElementById('licenciaCanvas');
    const link = document.createElement('a');
    link.download = 'licencia.png';
    link.href = canvas.toDataURL();
    link.click();
}
</script>

</body>
</html>
