<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Oficio de Imputación – Grooming</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      padding: 15px;
    }
    h2 {
      text-align: center;
    }
    .card {
      background: #ffffff;
      padding: 15px;
      border-radius: 8px;
    }
    label {
      font-weight: bold;
      margin-top: 10px;
      display: block;
    }
    input {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      box-sizing: border-box;
    }
    button {
      margin-top: 15px;
      width: 100%;
      padding: 12px;
      font-size: 16px;
      background: #003366;
      color: white;
      border: none;
      border-radius: 5px;
    }
  </style>
</head>

<body>

<h2>Generador de Oficio de Imputación</h2>

<div class="card">
  <label>Expediente Nº</label>
  <input id="expediente">

  <label>Fiscal Interino</label>
  <input id="fiscal">

  <label>Nombre del Imputado</label>
  <input id="imputado">

  <label>DNI del Imputado</label>
  <input id="dniImputado">

  <label>Iniciales de la Víctima</label>
  <input id="victima">

  <label>Edad de la Víctima</label>
  <input id="edad" type="number">

  <button onclick="generarPDF()">Generar y Descargar PDF</button>
</div>

<script>
  const { jsPDF } = window.jspdf;

  function generarPDF() {
    const doc = new jsPDF();
    let y = 20;

    const v = id => document.getElementById(id).value;

    doc.setFont("times", "bold");
    doc.setFontSize(14);
    doc.text("OFICIO DE IMPUTACIÓN PENAL", 105, y, { align: "center" });

    y += 15;
    doc.setFont("times", "normal");
    doc.setFontSize(11);

    doc.text("EXPTE Nº: " + v("expediente"), 20, y); y += 8;
    doc.text("Fiscalía de Abusos Sexuales – Ministerio Público Fiscal de Mendoza", 20, y); y += 8;
    doc.text("Fiscal Interino: " + v("fiscal"), 20, y); y += 12;

    doc.text("IMPUTADO:", 20, y); y += 8;
    doc.text("Nombre: " + v("imputado"), 25, y); y += 7;
    doc.text("DNI: " + v("dniImputado"), 25, y); y += 12;

    doc.text("VÍCTIMA:", 20, y); y += 8;
    doc.text("Iniciales: " + v("victima"), 25, y); y += 7;
    doc.text(
      "Edad: " + v("edad") + 
      " años – menor de edad con retraso madurativo",
      25,
      y
    );
    y += 14;

    doc.text("HECHO IMPUTADO:", 20, y); y += 8;

    const hechoFijo = `
Se imputa al nombrado haber mantenido contacto reiterado con una menor de edad a través de medios digitales, 
en particular mediante la aplicación de mensajería instantánea WhatsApp, enviando mensajes de contenido sexual 
explícito y material de carácter pornográfico, con fines sexuales.

Las conductas se desarrollaron aprovechándose de la condición de especial vulnerabilidad de la víctima, 
quien presenta retraso madurativo, afectando su integridad sexual y su normal desarrollo psicosexual.
    `;

    const hechoTxt = doc.splitTextToSize(hechoFijo.trim(), 170);
    doc.text(hechoTxt, 20, y);

    y += hechoTxt.length * 7 + 10;

    doc.text(
      "CALIFICACIÓN LEGAL: Los hechos encuadran prima facie en el delito de grooming, previsto y reprimido por el artículo 131 del Código Penal, en concurso real con el delito previsto en el artículo 128 del mismo cuerpo legal, conforme artículo 55 del Código Penal, todo ello agravado por la especial vulnerabilidad de la víctima (Ley 26.061).",
      20,
      y,
      { maxWidth: 170 }
    );

    y += 30;
    doc.text("Firma:", 20, y);
    doc.text(v("fiscal"), 20, y + 10);

    doc.save("Oficio_Imputacion_Grooming.pdf");
  }
</script>

</body>
</html>
